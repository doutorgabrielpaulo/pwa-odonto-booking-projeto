<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador de Reserva - Odonto Booking</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; }
.app-container { max-width: 420px; margin: auto; background-color: #f9fafb; min-height: 100vh; }
.toggle-checkbox:checked { right: 0; border-color: #3B82F6; }
.toggle-checkbox:checked + .toggle-label { background-color: #3B82F6; }
/* Estilos para o Calend√°rio */
.datepicker {
    display: none;
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    border: 1px solid #ddd;
    border-radius: 12px;
    padding: 10px;
    z-index: 100;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
.datepicker.visible { display: block; }
.datepicker-header { display: flex; justify-content: space-between; align-items: center; }
.datepicker-days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
.datepicker-day, .datepicker-weekday { text-align: center; padding: 8px; cursor: pointer; border-radius: 50%; }
.datepicker-weekday { font-weight: bold; font-size: 0.8em; }
.datepicker-day:hover { background-color: #eff6ff; }
.datepicker-day.today { background-color: #3b82f6; color: white; }
.datepicker-day.disabled { color: #ccc; cursor: not-allowed; }

/* Estilos adicionais para a sele√ß√£o de slots */
.slot-btn {
    @apply flex justify-between items-center w-full p-4 rounded-xl font-bold text-sm transition-all;
}
.slot-btn.available {
    @apply bg-white text-blue-600 border border-blue-600 cursor-pointer;
}
.slot-btn.available:hover {
    @apply bg-blue-50;
}
.slot-btn.occupied {
    @apply bg-gray-200 text-gray-500 cursor-not-allowed;
}
.slot-btn.selected {
    @apply bg-blue-600 text-white;
}

</style>
</head>
<body>

<div id="app" class="app-container">
<div id="rent-screen" class="p-4 space-y-4">
    <header class="flex items-center justify-between text-white bg-blue-600 -m-4 mb-4 p-4 shadow-md">
        <i class="fas fa-bars text-xl"></i>
        <h1 class="font-bold text-lg">ALUGAR</h1>
        <i class="fas fa-user-circle text-xl"></i>
    </header>

    <div class="bg-white p-3 rounded-xl shadow-md space-y-3">
        <label class="text-xs font-semibold text-blue-600">SELECIONE UMA DATA</label>
        <div class="relative flex gap-3">
            <a href="#" id="prev-day-btn" class="w-full p-2 bg-white border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 text-xs text-center flex items-center justify-center"><i class="fas fa-arrow-left mr-1"></i> ANTERIOR</a>
            <div id="date-display" class="relative w-full text-center p-2 bg-gray-100 border border-gray-200 rounded-lg font-semibold text-gray-800 text-sm cursor-pointer">
                </div>
            <a href="#" id="next-day-btn" class="w-full p-2 bg-white border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 text-xs text-center flex items-center justify-center">PR√ìXIMO <i class="fas fa-arrow-right ml-1"></i></a>
            
            <div id="datepicker" class="datepicker">
                <div class="datepicker-header">
                    <button id="prev-month-btn">&lt;</button>
                    <span id="month-year"></span>
                    <button id="next-month-btn">&gt;</button>
                </div>
                <div class="datepicker-weekdays grid grid-cols-7 text-center text-xs font-bold text-gray-500 my-2">
                    <span>Dom</span><span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>S√°b</span>
                </div>
                <div id="datepicker-days" class="datepicker-days"></div>
            </div>
        </div>
    </div>

    <div class="space-y-4">
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
             <div class="absolute top-2 right-2">
                <button class="bg-yellow-400 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg"><i class="fas fa-pencil-alt mr-1"></i> Editar</button>
            </div>
            <div class="aspect-video bg-black flex items-center justify-center h-40">
                <img src="https://img.youtube.com/vi/Z0u9_xUv0ms/mqdefault.jpg" class="w-full h-full object-cover">
            </div>
            <div class="p-3 space-y-3">
                <h3 class="font-bold text-base">CADEIRA MARGARIDA</h3>
                <p class="text-xs text-gray-500">SALA 122 - 12¬∞ ANDAR TORRE A</p>
                
                <div id="total-price-display" class="hidden text-center p-2.5 bg-green-100 text-green-800 font-bold rounded-lg border-2 border-green-200 text-sm">
                    </div>

                <div class="text-center py-1">
                    <p class="font-bold text-base text-gray-800">VALOR R$ 90,00/2H30</p>
                    <p class="font-semibold text-sm text-blue-600">VALOR R$ 55,00/1H15</p>
                </div>

                <div class="p-2.5 bg-red-50 border-l-4 border-red-400 text-red-800 rounded-r-lg flex items-center gap-3">
                    <i class="fas fa-exclamation-triangle text-lg"></i>
                    <p class="font-bold text-xs">ATEN√á√ÉO: AUTOCLAVE EM MANUTEN√á√ÉO</p>
                </div>
                
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg">
                    <span class="font-semibold text-gray-700 text-xs">HOR√ÅRIOS MENORES (1h15)</span>
                    <div class="relative inline-block w-10 mr-2 align-middle select-none">
                        <input type="checkbox" name="toggle" id="toggle-horarios-1" class="toggle-horarios toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                        <label for="toggle-horarios-1" class="toggle-label block overflow-hidden h-5 rounded-full bg-gray-300 cursor-pointer"></label>
                    </div>
                </div>

                <div class="slots-container space-y-2">
                    <button class="slot-btn available" data-price="90"><span><i class="fas fa-check-circle mr-2"></i> 07h00 - 09h30</span><span>DISPON√çVEL</span></button>
                    <div class="slot-btn occupied"><span><i class="fas fa-times-circle mr-2"></i> 09h30 - 12h00</span><span>OCUPADO</span></div>
                    <button class="slot-btn available" data-price="90"><span><i class="fas fa-check-circle mr-2"></i> 12h00 - 14h30</span><span>DISPON√çVEL</span></button>
                    <button class="slot-btn available" data-price="90"><span><i class="fas fa-check-circle mr-2"></i> 14h30 - 17h00</span><span>DISPON√çVEL</span></button>
                    <button class="slot-btn available" data-price="90"><span><i class="fas fa-check-circle mr-2"></i> 17h00 - 19h30</span><span>DISPON√çVEL</span></button>
                </div>

                <button id="proceed-to-reserve-btn" class="hidden w-full p-2.5 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 text-sm mt-4">Continuar para Reserva</button>
            </div>
        </div>
    </div>
</div>

<div id="confirmation-popup" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm text-center space-y-4">
        <i class="fas fa-question-circle text-4xl text-blue-500"></i>
        <h3 class="text-lg font-bold text-gray-800">Confirmar Reserva?</h3>
        <p class="text-sm text-gray-600">Voc√™ est√° prestes a reservar:</p>
        <div id="confirmation-text" class="text-left bg-gray-100 p-3 rounded-lg border border-gray-200 text-sm space-y-1">
            </div>
        <div class="flex gap-3 mt-4">
            <button id="cancel-reservation-btn" class="w-full p-2.5 bg-gray-200 text-gray-800 font-bold rounded-lg hover:bg-gray-300 text-sm">Cancelar</button>
            <button id="confirm-reservation-btn" class="w-full p-2.5 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 text-sm">Confirmar</button>
        </div>
    </div>
</div>

<div id="post-reservation-popup" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm text-center space-y-4">
        <i class="fas fa-check-circle text-4xl text-green-500"></i>
        <h3 class="text-lg font-bold text-gray-800">Reserva Realizada!</h3>
        <p class="text-sm text-gray-600">Para garantir o melhor uso da sala, gostar√≠amos de saber:</p>
        <div class="text-left space-y-3">
            <div class="bg-gray-50 p-3 rounded-lg">
                <p class="font-semibold text-sm mb-2">Voc√™ j√° sabe utilizar a Autoclave?</p>
                <div class="flex gap-2">
                    <button class="tutorial-choice w-full p-2 bg-white border border-gray-300 rounded-lg text-xs font-semibold">Sim, j√° sei</button>
                    <button class="tutorial-choice w-full p-2 bg-blue-100 border border-blue-300 text-blue-800 rounded-lg text-xs font-semibold">N√£o, ver tutorial</button>
                </div>
            </div>
             <div class="bg-gray-50 p-3 rounded-lg">
                <p class="font-semibold text-sm mb-2">Voc√™ j√° sabe utilizar a Plastificadora?</p>
                <div class="flex gap-2">
                    <button class="tutorial-choice w-full p-2 bg-white border border-gray-300 rounded-lg text-xs font-semibold">Sim, j√° sei</button>
                    <button class="tutorial-choice w-full p-2 bg-blue-100 border border-blue-300 text-blue-800 rounded-lg text-xs font-semibold">N√£o, ver tutorial</button>
                </div>
            </div>
        </div>
        <div class="pt-2">
            <button id="finish-flow-btn" class="w-full p-2.5 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 text-sm">Continuar</button>
        </div>
    </div>
</div>

<div id="summary-screen" class="hidden p-4 space-y-4">
    <header class="flex items-center justify-center text-white bg-blue-600 -m-4 mb-4 p-4 shadow-md">
        <h1 class="font-bold text-lg">RESERVA CONFIRMADA</h1>
    </header>
    <div class="text-center bg-white p-6 rounded-2xl shadow-lg">
        <i class="fas fa-calendar-check text-5xl text-green-500 mb-4"></i>
        <h2 class="text-xl font-bold text-gray-800">Tudo Certo!</h2>
        <p class="text-sm text-gray-600 mb-6">Sua reserva para a <strong>Cadeira Margarida</strong> no dia <strong id="summary-date"></strong> est√° confirmada.</p>
        
        <div class="space-y-3">
            <p class="text-xs font-semibold text-gray-500">Hor√°rios Reservados:</p>
            <ul id="summary-times" class="list-disc list-inside text-sm font-semibold text-gray-800"></ul>
        </div>
        
        <div class="space-y-3 mt-6">
            <p class="text-xs font-semibold text-gray-500">PR√ìXIMOS PASSOS:</p>
            <a href="#" class="w-full flex items-center p-3 bg-gray-100 rounded-lg shadow-sm hover:bg-gray-200 transition-colors border">
                <i class="fas fa-microscope w-6 text-center text-lg text-blue-600"></i><span class="ml-3 font-semibold text-sm text-gray-800">Alugar Equipamentos</span>
            </a>
            <a href="#" class="w-full flex items-center p-3 bg-gray-100 rounded-lg shadow-sm hover:bg-gray-200 transition-colors border">
                <i class="fas fa-car w-6 text-center text-lg text-blue-600"></i><span class="ml-3 font-semibold text-sm text-gray-800">Reservar Vaga de Garagem</span>
            </a>
        </div>

        <div class="mt-6">
            <button id="back-to-rent-screen" class="w-full p-2.5 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 text-sm">Voltar</button>
        </div>

        <div class="flex items-center gap-2 mt-4 text-xs text-gray-500">
            <input type="checkbox" id="dont-ask-again">
            <label for="dont-ask-again">N√£o me perguntar sobre equipamentos/garagem novamente.</label>
        </div>
    </div>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- ESTADO DA APLICA√á√ÉO ---
    let currentDate = new Date();
    let selectedSlots = new Set();
    const slotData = {};

    // --- ELEMENTOS DO DOM ---
    const dateDisplay = document.getElementById('date-display');
    const prevDayBtn = document.getElementById('prev-day-btn');
    const nextDayBtn = document.getElementById('next-day-btn');
    const confirmationPopup = document.getElementById('confirmation-popup');
    const confirmationText = document.getElementById('confirmation-text');
    const cancelReservationBtn = document.getElementById('cancel-reservation-btn');
    const confirmReservationBtn = document.getElementById('confirm-reservation-btn');
    const postReservationPopup = document.getElementById('post-reservation-popup');
    const finishFlowBtn = document.getElementById('finish-flow-btn');
    const rentScreen = document.getElementById('rent-screen');
    const summaryScreen = document.getElementById('summary-screen');
    const backToRentScreen = document.getElementById('back-to-rent-screen');
    const datePickerElement = document.getElementById('datepicker');
    const monthYearElement = document.getElementById('month-year');
    const daysContainer = document.getElementById('datepicker-days');
    const prevMonthBtn = document.getElementById('prev-month-btn');
    const nextMonthBtn = document.getElementById('next-month-btn');
    const totalPriceDisplay = document.getElementById('total-price-display');
    const proceedToReserveBtn = document.getElementById('proceed-to-reserve-btn');

    // --- FUN√á√ïES DE UTILIDADE ---
    function formatDate(date) {
        return date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
    }

    function updateDateDisplay() {
        dateDisplay.textContent = formatDate(currentDate);
        renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
    }

    function renderCalendar(year, month) {
        daysContainer.innerHTML = '';
        monthYearElement.textContent = new Date(year, month).toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
        
        const firstDayOfMonth = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        
        for (let i = 0; i < firstDayOfMonth; i++) {
            daysContainer.appendChild(document.createElement('div'));
        }
        
        for (let day = 1; day <= daysInMonth; day++) {
            const dayElement = document.createElement('div');
            dayElement.textContent = day;
            dayElement.classList.add('datepicker-day');
            if (day === new Date().getDate() && month === new Date().getMonth() && year === new Date().getFullYear()) {
                dayElement.classList.add('today');
            }
            dayElement.addEventListener('click', () => {
                currentDate = new Date(year, month, day);
                updateDateDisplay();
                datePickerElement.classList.remove('visible');
            });
            daysContainer.appendChild(dayElement);
        }
    }

    function updateTotal() {
        let totalPrice = 0;
        selectedSlots.forEach(id => {
            const btn = document.getElementById(id);
            totalPrice += parseFloat(btn.dataset.price);
        });

        if (totalPrice > 0) {
            totalPriceDisplay.innerHTML = `üí∏ Total a Pagar: <strong>R$ ${totalPrice.toFixed(2)}</strong> üí∏`;
            totalPriceDisplay.classList.remove('hidden');
            proceedToReserveBtn.classList.remove('hidden');
        } else {
            totalPriceDisplay.classList.add('hidden');
            proceedToReserveBtn.classList.add('hidden');
        }
    }

    // --- EVENT LISTENERS ---
    prevDayBtn.addEventListener('click', (e) => { e.preventDefault(); currentDate.setDate(currentDate.getDate() - 1); updateDateDisplay(); });
    nextDayBtn.addEventListener('click', (e) => { e.preventDefault(); currentDate.setDate(currentDate.getDate() + 1); updateDateDisplay(); });

    dateDisplay.addEventListener('click', () => datePickerElement.classList.toggle('visible'));
    prevMonthBtn.addEventListener('click', () => { currentDate.setMonth(currentDate.getMonth() - 1); updateDateDisplay(); });
    nextMonthBtn.addEventListener('click', () => { currentDate.setMonth(currentDate.getMonth() + 1); updateDateDisplay(); });

    // L√≥gica para selecionar/desselecionar slots
    document.querySelectorAll('.slot-btn.available').forEach((btn, index) => {
        // Atribui um ID √∫nico a cada bot√£o
        const slotId = `slot-${index}`;
        btn.id = slotId;
        slotData[slotId] = btn.textContent.trim();

        btn.addEventListener('click', () => {
            if (selectedSlots.has(slotId)) {
                selectedSlots.delete(slotId);
                btn.classList.remove('selected');
                btn.innerHTML = `<span><i class="fas fa-check-circle mr-2"></i> ${slotData[slotId]}</span><span>DISPON√çVEL</span>`;
            } else {
                selectedSlots.add(slotId);
                btn.classList.add('selected');
                btn.innerHTML = `<span><i class="fas fa-user-check mr-2"></i> ${slotData[slotId]}</span><span>SELECIONADO</span>`;
            }
            updateTotal();
        });
    });

    // Bot√£o para iniciar o fluxo de reserva
    proceedToReserveBtn.addEventListener('click', () => {
        let confirmationHtml = ``;
        let totalPrice = 0;
        selectedSlots.forEach(id => {
            const btn = document.getElementById(id);
            const timeText = btn.textContent.trim().split('SELECIONADO')[0];
            confirmationHtml += `
                <div class="flex justify-between items-center py-1">
                    <span class="font-semibold text-gray-700">${timeText}</span>
                    <span class="font-bold text-green-700">R$ ${parseFloat(btn.dataset.price).toFixed(2)}</span>
                </div>
            `;
            totalPrice += parseFloat(btn.dataset.price);
        });

        confirmationHtml += `<div class="border-t border-gray-300 my-2"></div>
                             <div class="flex justify-between items-center text-base font-bold text-gray-800">
                                 <span>Total:</span>
                                 <span>R$ ${totalPrice.toFixed(2)}</span>
                             </div>`;
                             
        confirmationText.innerHTML = confirmationHtml;
        confirmationPopup.classList.remove('hidden');
    });

    cancelReservationBtn.addEventListener('click', () => confirmationPopup.classList.add('hidden'));

    confirmReservationBtn.addEventListener('click', () => {
        confirmationPopup.classList.add('hidden');
        postReservationPopup.classList.remove('hidden');
    });

    finishFlowBtn.addEventListener('click', () => {
        postReservationPopup.classList.add('hidden');
        rentScreen.classList.add('hidden');
        summaryScreen.classList.remove('hidden');
        
        // Atualiza a tela de resumo com os hor√°rios selecionados
        document.getElementById('summary-date').textContent = formatDate(currentDate);
        const summaryTimesList = document.getElementById('summary-times');
        summaryTimesList.innerHTML = '';
        selectedSlots.forEach(id => {
            const btn = document.getElementById(id);
            const timeText = btn.textContent.trim().split('SELECIONADO')[0];
            const listItem = document.createElement('li');
            listItem.textContent = timeText;
            summaryTimesList.appendChild(listItem);
        });
    });

    backToRentScreen.addEventListener('click', () => {
        summaryScreen.classList.add('hidden');
        rentScreen.classList.remove('hidden');
        // Limpa a sele√ß√£o e reseta o estado dos bot√µes
        selectedSlots.forEach(id => {
            const btn = document.getElementById(id);
            btn.classList.remove('selected');
            btn.innerHTML = `<span><i class="fas fa-check-circle mr-2"></i> ${slotData[id]}</span><span>DISPON√çVEL</span>`;
        });
        selectedSlots.clear();
        updateTotal();
    });

    document.querySelectorAll('.tutorial-choice').forEach(btn => {
        btn.addEventListener('click', () => {
            const parent = btn.parentElement;
            parent.querySelectorAll('.tutorial-choice').forEach(b => b.classList.remove('bg-blue-100', 'border-blue-300', 'text-blue-800'));
            parent.querySelectorAll('.tutorial-choice').forEach(b => b.classList.add('bg-white', 'border-gray-300'));
            btn.classList.add('bg-blue-100', 'border-blue-300', 'text-blue-800');
        });
    });

    // --- INICIALIZA√á√ÉO ---
    updateDateDisplay();
});
</script>
</body>
</html>
